{% extends "setting_base.html" %}
{% load i18n utiltags %}
{% block submenu %}{% call "personsubmenu.html" with currentpage="edit" %}{% endblock %}
{% block menu %}{% call "menu.html" with currentpage="personal" %}{% endblock %}
{% block body %}
<script type="text/javascript">
$(document).ready(function (){
	var user_login = new AjaxForm('#user_edit');
});
</script>
{% catch as header %}
    <h1>个人信息</h1>
{% endcatch %}
{% catch as content %}
<form action="/user/{{ person.id }}/edit/" method="post" id="user_edit">
    <div class="basic_form">
        <div id="message"></div>
        <h2>基本信息</h2>
        <div class="block">
            <dl>
                <dt>用户名：</dt>
                <dd>{{ person.username }}<dd>
            </dl>
        </div>
        {% call "utils/add_field.html" with description="输入邮箱" label="邮　箱：" field=baseform.email %}
        <p class="blockintro">设置新口令，如果不想修改可以不填</p>
        <div class="block">
            <dl>
                <dt><lable for="">口　　令：</lable></dt>
                <dd>{{ baseform.password }}<dd>
            </dl>
            <dl>
                <dt><lable for="">重输口令：</lable></dt>
                <dd>{{ baseform.password1 }}<dd>
            </dl>
        </div>
        <div class="action">
            <input type="submit" value="提交" />
        </div>
    </div>
</form>
<form enctype="multipart/form-data" action="/user/{{ person.id }}/saveportrait/" method="post">
    <div class="basic_form">
        <h2>用户头像</h2>
        {% if photoform.errors %}<p class="errornote">{% trans "Please correct blow errors." %}</p>
        <ul class="errorlist">
        {% for e in photoform.errors %}
            <li><a href="javascript:document.getElementById('id_{{ e.0 }}').focus()"><b>{{ e.1 }}:</b> {{ e.2 }}</a></li>
        {% endfor %}
        </ul>
        {% endif %}
        <p class="blockintro">选择一个图片作为头像</p>
        <div class="block">
            <dl>
                <dt class="required"><lable for="">文件：</lable></dt>
                <dd>{{ photoform.portrait }}<dd>
            </dl>
        </div>
        <div class="action">
            <input type="submit" value="上传" />
        </div>
    </div>
</form>
{% endcatch %}
{% catch as sidebar %}
    <h1>{{ person.username }}</h1>
    {% if user.userprofile.portrait %}
        <img src="/site_media/{{ person.userprofile.get_portrait_url }}" />
    {% endif %}
    <p>邮箱：{{ person.email }}</p>
{% endcatch %}
{% call "utils/contentframe.html" with header content sidebar %}
{% endblock %}
